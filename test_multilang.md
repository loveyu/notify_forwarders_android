# 多语言功能测试指南

## 已实现的功能

### 1. 支持的语言
- 简体中文（默认）
- 英文 (English)
- 繁体中文 (繁體中文)
- 日语 (日本語)
- 俄语 (Русский)
- 法语 (Français)
- 德语 (Deutsch)

### 2. 功能特性
- **自动语言检测**：首次启动时根据系统语言自动选择最佳匹配语言
- **手动语言切换**：在设置页面可以手动选择语言
- **即时生效**：语言切换后应用会自动重启以应用新语言
- **持久化存储**：语言选择会被保存，下次启动时继续使用

### 3. 语言匹配规则
- 中文系统：
  - 中国大陆、新加坡等 → 简体中文
  - 台湾、香港、澳门 → 繁体中文
- 其他语言直接匹配
- 不支持的语言默认使用简体中文

## 测试步骤

### 1. 安装应用
```bash
./gradlew assembleDebug
adb install app/build/outputs/apk/debug/app-debug.apk
```

### 2. 测试自动语言检测
1. 在不同语言的设备上安装应用
2. 首次启动应用
3. 验证界面语言是否正确

### 3. 测试手动语言切换
1. 打开应用
2. 点击右上角设置图标
3. 滚动到底部找到"语言设置"卡片
4. 点击"选择语言"按钮
5. 在弹出的对话框中选择不同语言
6. 验证应用是否重启并应用新语言

### 4. 测试语言持久化
1. 切换到非系统默认语言
2. 完全关闭应用
3. 重新启动应用
4. 验证语言设置是否保持

## 验证要点

### 界面元素检查
- [ ] 应用标题
- [ ] 设置页面标题
- [ ] 所有按钮文本
- [ ] 提示信息
- [ ] 对话框内容
- [ ] 错误消息

### 功能验证
- [ ] 语言选择对话框显示正确
- [ ] 当前语言正确高亮
- [ ] 语言切换后应用自动重启
- [ ] 重启后界面语言正确更新
- [ ] 语言设置持久化保存

## 已知问题和限制

1. **应用重启**：语言切换需要重启应用才能完全生效
2. **系统通知**：系统级通知可能仍显示系统语言
3. **第三方库**：某些第三方组件可能不支持动态语言切换

## 文件结构

```
app/src/main/res/
├── values/strings.xml              # 简体中文（默认）
├── values-en/strings.xml           # 英文
├── values-zh-rTW/strings.xml       # 繁体中文
├── values-ja/strings.xml           # 日语
├── values-ru/strings.xml           # 俄语
├── values-fr/strings.xml           # 法语
└── values-de/strings.xml           # 德语
```

## 核心类

- `LocaleHelper`: 语言切换核心逻辑
- `NotifyForwardersApplication`: 应用启动时应用语言设置
- `ServerPreferences`: 语言偏好存储
- `SettingsActivity`: 语言选择界面
